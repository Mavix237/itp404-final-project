{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Link,Outlet}from'react-router-dom';import{toast}from'react-toastify';import{setDocumentTitle}from'../utils';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function Songbook(){useEffect(()=>{setDocumentTitle('Your Songbook');},[]);const[songs,setSongs]=useState([]);const[isLoaded,setIsLoaded]=useState(false);const[isLoading,setIsLoading]=useState(false);const fetchSongs=async()=>{// GET\nif(!isLoaded){setIsLoading(true);try{const response=await fetch('http://localhost:3001/songs');if(!response.ok)throw new Error('Failed to fetch songs');const data=await response.json();setSongs(data);setIsLoaded(true);toast.success('Songs loaded successfully!');}catch(error){console.error('Error:',error);toast.error('Failed to load songs');}finally{// Delay the loading state change to make the spinner more visible\nsetTimeout(()=>{setIsLoading(false);},300);}}};//DELETE\nconst handleDelete=async id=>{try{const response=await fetch(`http://localhost:3001/songs/${id}`,{method:'DELETE'});if(!response.ok)throw new Error('Failed to delete song');setSongs(songs.filter(song=>song.id!==id));toast.success('Song deleted successfully!');}catch(error){console.error('Error:',error);toast.error('Failed to delete song');}};return/*#__PURE__*/_jsx(\"div\",{className:\"container mt-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-4\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Your Songbook\"}),/*#__PURE__*/_jsx(\"button\",{className:`btn btn-primary mb-3 ${isLoading?'disabled':''}`,onClick:fetchSongs,disabled:isLoading,children:isLoading?/*#__PURE__*/_jsx(\"span\",{className:\"spinner-border spinner-border-sm\",role:\"status\",\"aria-hidden\":\"true\"}):isLoaded?'Refresh Songs':'Load Songs'}),!isLoading&&isLoaded&&/*#__PURE__*/_jsx(\"div\",{className:\"list-group\",children:songs.map(song=>/*#__PURE__*/_jsxs(\"div\",{className:\"list-group-item d-flex justify-content-between align-items-center\",children:[/*#__PURE__*/_jsxs(Link,{to:`/songbook/${song.id}`,className:\"text-decoration-none\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"mb-1\",children:song.title}),/*#__PURE__*/_jsx(\"small\",{className:\"text-muted\",children:song.artist})]}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-danger btn-sm ms-2\",onClick:()=>handleDelete(song.id),children:\"Delete\"})]},song.id))})]}),/*#__PURE__*/_jsx(\"div\",{className:\"col-md-8\",children:/*#__PURE__*/_jsx(Outlet,{})})]})});}","map":{"version":3,"names":["React","useState","useEffect","Link","Outlet","toast","setDocumentTitle","jsx","_jsx","jsxs","_jsxs","Songbook","songs","setSongs","isLoaded","setIsLoaded","isLoading","setIsLoading","fetchSongs","response","fetch","ok","Error","data","json","success","error","console","setTimeout","handleDelete","id","method","filter","song","className","children","onClick","disabled","role","map","to","title","artist"],"sources":["/Users/mavix/Desktop/React ITP 404/final-project/src/Pages/Songbook.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Link, Outlet } from 'react-router-dom';\nimport { toast } from 'react-toastify';\nimport { setDocumentTitle } from '../utils';\n\nexport default function Songbook() {\n  useEffect(() => {\n    setDocumentTitle('Your Songbook');\n  }, []);\n  const [songs, setSongs] = useState([]);\n  const [isLoaded, setIsLoaded] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n\n  const fetchSongs = async () => {\n    // GET\n    if (!isLoaded) {\n      setIsLoading(true);\n      try {\n        const response = await fetch('http://localhost:3001/songs');\n        if (!response.ok) throw new Error('Failed to fetch songs');\n        const data = await response.json();\n        setSongs(data);\n        setIsLoaded(true);\n        toast.success('Songs loaded successfully!');\n      } catch (error) {\n        console.error('Error:', error);\n        toast.error('Failed to load songs');\n      } finally {\n        // Delay the loading state change to make the spinner more visible\n        setTimeout(() => {\n          setIsLoading(false);\n        }, 300);\n      }\n    }\n  };\n\n  //DELETE\n  const handleDelete = async (id) => {\n    try {\n      const response = await fetch(`http://localhost:3001/songs/${id}`, {\n        method: 'DELETE',\n      });\n      if (!response.ok) throw new Error('Failed to delete song');\n      setSongs(songs.filter(song => song.id !== id));\n      toast.success('Song deleted successfully!');\n    } catch (error) {\n      console.error('Error:', error);\n      toast.error('Failed to delete song');\n    }\n  };\n\n  return (\n    <div className=\"container mt-4\">\n      <div className=\"row\">\n        <div className=\"col-md-4\">\n          <h2>Your Songbook</h2>\n          <button\n            className={`btn btn-primary mb-3 ${isLoading ? 'disabled' : ''}`}\n            onClick={fetchSongs}\n            disabled={isLoading}\n          >\n            {isLoading ? (\n              <span className=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span>\n            ) : isLoaded ? 'Refresh Songs' : 'Load Songs'}\n          </button>\n          {!isLoading && isLoaded && (\n            <div className=\"list-group\">\n              {songs.map(song => (\n                <div key={song.id} className=\"list-group-item d-flex justify-content-between align-items-center\">\n                  <Link to={`/songbook/${song.id}`} className=\"text-decoration-none\">\n                    <h5 className=\"mb-1\">{song.title}</h5>\n                    <small className=\"text-muted\">{song.artist}</small>\n                  </Link>\n                  <button\n                    className=\"btn btn-danger btn-sm ms-2\"\n                    onClick={() => handleDelete(song.id)}\n                  >\n                    Delete\n                  </button>\n                </div>\n              ))}\n            </div>\n          )}\n        </div>\n        <div className=\"col-md-8\">\n          <Outlet />\n        </div>\n      </div>\n    </div>\n  );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}